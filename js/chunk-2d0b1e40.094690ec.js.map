{"version":3,"sources":["webpack:///./src/markdown/2020/awssimulatekillingavailabilityzone.md?f374","webpack:///./src/markdown/2020/awssimulatekillingavailabilityzone.md"],"names":["render","_vm","this","_h","$createElement","_self","_c","_m","staticRenderFns","_v","attrs","pre","script","component"],"mappings":"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","file":"js/chunk-2d0b1e40.094690ec.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_c('h1',[_vm._v(\"AWS simulate killing an Availability Zone\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/i/1qhsppqsoflzcyq0ewe3.jpg\",\"alt\":\"\"}})]),_c('p',[_vm._v(\"At some stage in development of a high availability application you will want test what happens when an Availability Zone goes down in AWS.\")]),_c('h2',[_vm._v(\"Disabling AZ\")]),_c('p',[_vm._v(\"Blocking all network traffic to AZ seems the best way to simulate this. The method I used was to change the ACL for all the subnets on an AZ to new ACL. The AWS cli creates ACL with Deny All traffic by default for new ACL's.\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-meta\"}},[_vm._v(\"#!/bin/bash\\n\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# prereq\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"#  - jq\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"#  - aws-cli\")]),_vm._v(\"\\n\\nAZ=eu-west-1c\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# use the subnetId to get the NetworkAclAssociationId to create the new acl association\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"for\")]),_vm._v(\" SUBNETID \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"in\")]),_vm._v(\" $(aws ec2 describe-subnets --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\"| jq \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\".Subnets[] | select(.AvailabilityZone==\\\\\\\"\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$AZ\")]),_vm._v(\"\\\\\\\")\\\"\")]),_vm._v(\"  | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"'.SubnetId'\")]),_vm._v(\")\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"do\")]),_vm._v(\"\\n  aws ec2 describe-network-acls --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\"| jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\".[] | .[].Associations[] | select(.SubnetId==\\\\\\\"\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$SUBNETID\")]),_vm._v(\"\\\\\\\")\\\"\")]),_vm._v(\" | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"'.NetworkAclAssociationId'\")]),_vm._v(\" >> NetworkAclAssociationId.tmp\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Need to take a backup of the original NetworkAclId's to be able to reverse the change\")]),_vm._v(\"\\n  aws ec2 describe-network-acls --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\"| jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\".[] | .[].Associations[] | select(.SubnetId==\\\\\\\"\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$SUBNETID\")]),_vm._v(\"\\\\\\\")\\\"\")]),_vm._v(\" | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"'.NetworkAclId'\")]),_vm._v(\" >> NetworkAclId-restore.tmp\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"done\")]),_vm._v(\"\\n\")])]),_c('p',[_vm._v(\"As I have multiple VPC I needed to create a different ACL for each VPC .\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# create the dummy ACL and create a file containing the NetworkAclId for the dummy ACL for each VPC\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"for\")]),_vm._v(\" VPCID \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"in\")]),_vm._v(\" $(aws ec2 describe-subnets --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\" | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\".Subnets[] | select(.AvailabilityZone==\\\\\\\"\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$AZ\")]),_vm._v(\"\\\\\\\")\\\"\")]),_vm._v(\"  | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"'.VpcId'\")]),_vm._v(\")\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"do\")]),_vm._v(\"\\n  aws ec2 create-network-acl --vpc-id \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$VPCID\")]),_vm._v(\" --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\" | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"'.NetworkAcl.NetworkAclId'\")]),_vm._v(\" >> NetworkAclId.tmp\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"done\")]),_vm._v(\"\\n\")])]),_c('p',[_vm._v(\"I then created a function that takes the lists of NetworkAclAssociationId and NetworkAclId and changes the ACL association\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Function ChangeAcl takes two arguments for disable or enable\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# $1 should be NetworkAclAssociationId filename\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# $2 should be NetworkAclId filename\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"function\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-function\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-title\"}},[_vm._v(\"ChangeAcl\")])]),_vm._v(\"() {\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# needed to read from two files so used a count to poll through the lines of the second file\")]),_vm._v(\"\\n  count=1\\n  cat \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$1\")]),_vm._v(\" | \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"while\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-built_in\"}},[_vm._v(\"read\")]),_vm._v(\" NetworkAclAssociationId\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"do\")]),_vm._v(\"\\n    \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-built_in\"}},[_vm._v(\"echo\")]),_vm._v(\" $(sed -n \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\"\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${count}\")]),_vm._v(\"p\\\"\")]),_vm._v(\" < \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$2\")]),_vm._v(\")\\n    \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-built_in\"}},[_vm._v(\"echo\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$NetworkAclAssociationId\")]),_vm._v(\"\\n    aws ec2 replace-network-acl-association --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\" --association-id \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$NetworkAclAssociationId\")]),_vm._v(\" --network-acl-id $(sed -n \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\"\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${count}\")]),_vm._v(\"p\\\"\")]),_vm._v(\" < \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$2\")]),_vm._v(\")\\n    ((count=count+1))\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"done\")]),_vm._v(\"\\n}\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Call the function to create new disable ACL association\")]),_vm._v(\"\\nChangeAcl NetworkAclAssociationId.tmp NetworkAclId.tmp\\n\")])]),_c('p',[_vm._v(\"At this point I have disable all traffic to a particular AZ and now I can check if resources are redistributed as expected and there is no downtime.\")]),_c('h2',[_vm._v(\"Re-enabling again\")]),_c('p',[_vm._v(\"It takes a few extra steps to re-enable again\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Get the new networkAclAssociationId for the subnets\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"for\")]),_vm._v(\" SUBNETID \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"in\")]),_vm._v(\" $(aws ec2 describe-subnets --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\" | jq \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\".Subnets[] | select(.AvailabilityZone==\\\\\\\"\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$AZ\")]),_vm._v(\"\\\\\\\")\\\"\")]),_vm._v(\" | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"'.SubnetId'\")]),_vm._v(\")\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"do\")]),_vm._v(\"\\n  aws ec2 describe-network-acls --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\" | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\".[] | .[].Associations[] | select(.SubnetId==\\\\\\\"\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$SUBNETID\")]),_vm._v(\"\\\\\\\")\\\"\")]),_vm._v(\" | jq -r \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"'.NetworkAclAssociationId'\")]),_vm._v(\" >> NetworkAclAssociationId-restore.tmp\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"done\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Restore the subnets to the original ACL's\")]),_vm._v(\"\\nChangeAcl NetworkAclAssociationId-restore.tmp NetworkAclId-restore.tmp\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# delete the dummy ACL's\")]),_vm._v(\"\\ncat NetworkAclId.tmp | \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"while\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-built_in\"}},[_vm._v(\"read\")]),_vm._v(\" deleteNetworkAclId\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"do\")]),_vm._v(\"\\n  aws ec2 delete-network-acl --network-acl-id \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"$deleteNetworkAclId\")]),_vm._v(\" --region \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-variable\"}},[_vm._v(\"${AZ%?}\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"done\")]),_vm._v(\"\\n\")])]),_c('p',[_vm._v(\"That's it, all traffic should be restored to original configuration.\")])])}]\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./awssimulatekillingavailabilityzone.md?vue&type=template&id=3f418c12&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}