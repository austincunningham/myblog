{"version":3,"sources":["webpack:///./src/markdown/2021/expressgrafana.md?6f66","webpack:///./src/markdown/2021/expressgrafana.md"],"names":["render","_vm","this","_h","$createElement","_self","_c","_m","staticRenderFns","_v","attrs","pre","script","component"],"mappings":"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","file":"js/chunk-2d0d607c.b97651e0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_c('h1',[_vm._v(\"Use Grafana to plot Express.js apps Metrics\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/m8qa0ki1ulufkgsfia7a.png\",\"alt\":\"banner image\"}})]),_c('p',[_vm._v(\"In this blog \"),_c('a',{attrs:{\"href\":\"https://austincunningham.ddns.net/2021/expressprometheus\"}},[_vm._v(\"get-prometheus-metrics-from-a-express-js-app\")]),_vm._v(\" I exposed the metrics from an Express.js app to Prometheus. Now I am going to used these metrics in Grafana.\")]),_c('h2',[_vm._v(\"Install Grafana\")]),_c('p',[_vm._v(\"Create a new project\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_vm._v(\"oc new-project grafana\\n\")])]),_c('p',[_vm._v(\"We can use the OperatorHub in Red Hat Openshift to install the Grafana-operator. I have logged in as kubeadmin user,and navigate to the OperatorHub and search for Grafana\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/h3ul6hk9x5lfodx2d0ch.png\",\"alt\":\"screenshot of Grafana in operatorhub\"}})]),_c('p',[_vm._v(\"Select the Grafana tile and continue on the install screen select install button\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/5jqs9x4h0j02k6a1xf4v.png\",\"alt\":\"screenshot of install button\"}})]),_c('p',[_vm._v(\"In the next screen select the grafana namespace and click install again\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/64v3k1r81gdv2zadezh2.png\",\"alt\":\"screenshot of namespace selector\"}})]),_c('p',[_vm._v(\"The operator should complete installing once finished go to the view operator button\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/4a8z5k4cad7w7tkx35jn.png\",\"alt\":\"View operator button\"}})]),_c('p',[_vm._v(\"We need to create a CR(custom resource) for Grafana to create a Grafana instance in the Grafana tile click on the create instance link\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/un159zkw14ysts5i7wrk.png\",\"alt\":\"screenshot of grafana CR tile\"}})]),_c('p',[_vm._v(\"This will bring you to a form to populate the Grafana CR I just add a name and click create button\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/mxo5gnal17wzz9d257an.png\",\"alt\":\"screenshot of grafana CR form\"}})]),_c('p',[_vm._v(\"Thats it the Grafana instance should start, there is also a route created in the Grafana namespace.\")]),_c('h2',[_vm._v(\"Connecting to prometheus\")]),_c('p',[_vm._v(\"Open the Grafana route in the browser\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_vm._v(\"oc project grafana\\noc get routes\\nNAME            HOST/PORT                                PATH   SERVICES          PORT   TERMINATION   WILDCARD\\ngrafana-route   grafana-route-grafana.apps-crc.testing          grafana-service   3000   edge          None\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# the HOST/PORT is the route so http://grafana-route-grafana.apps-crc.testing should open the grafana console\")]),_vm._v(\"\\n\")])]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/mw1a5v8m2uzh0quzok51.png\",\"alt\":\"screenshot of Grafana\"}})]),_c('p',[_vm._v(\"We will need to login to Grafana to be able to do anything. You can get the credentials for grafana in the Grafana CR\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_vm._v(\"oc get grafana grafana -o yaml | grep admin\\n            f:admin_password: {}\\n            f:admin_user: {}\\n      admin_password: secret\\n      admin_user: root\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# You can edit the secret in the Grafana CR also to change it from the default. \")]),_vm._v(\"\\n\")])]),_c('p',[_vm._v(\"Select the Sign In on the bottom of the screen\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lohxk3vzszycznxak816.png\",\"alt\":\"sign in \"}})]),_c('p',[_vm._v(\"And used the admin credentials in the login screen\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/4h5k7ilaw1qi96dcbvce.png\",\"alt\":\"Login screen\"}})]),_c('p',[_vm._v(\"We can now connect Grafana to Prometheus by adding a data source. Go to the now available gear icon, and select Data Source and select Prometheus as show below\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/617p5ax5ikmbtmd67m8z.gif\",\"alt\":\"navigate to add prometheus datasource\"}})]),_c('p',[_vm._v(\"In the Data Source form in the HTML section add url for the Prometheus service. The service url is in the following format.\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# service-name.service-namespace.svc:port\")]),_vm._v(\"\\nhttp://prometheus.default.svc:9090\\n\")])]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/i2l4x2tsj0kg5fxa2gri.gif\",\"alt\":\"Add data source url\"}})]),_c('p',[_vm._v(\"You can now see prometheus metrics in grafana.\")]),_c('h2',[_vm._v(\"Add some useful metrics to Grafana\")]),_c('p',[_vm._v(\"You can play around with the Grafana UI to get familiar with it creating dashboards and panels or read the \"),_c('a',{attrs:{\"href\":\"https://grafana.com/docs/grafana/latest/panels/add-a-panel/\"}},[_vm._v(\"Grafana docs\")]),_vm._v(\". Mainly its about adding the Prometheus expressions and pointing at the right data source.\")]),_c('p',[_c('strong',[_vm._v(\"http_request_duration_seconds_bucket\")]),_vm._v(\"\\nOne of the metrics we get from the Express.js app is http_request_duration_seconds_bucket. When we use this metric Grafana prompts us to use \"),_c('a',{attrs:{\"href\":\"https://prometheus.io/docs/practices/histograms/#quantiles\"}},[_vm._v(\"Histogram_quantile\")]),_vm._v(\" with this metric.\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/oh4cpv496kp7ey0ie93k.gif\",\"alt\":\"http_request_duration_seconds_bucket\"}})]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Prometheus Expression aggregates the 95th percentile\")]),_vm._v(\"\\nhistogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[5m])) by (le))\\n\")])]),_c('p',[_vm._v(\"As you can see I'm not seeing anything on the graph. This is because I am not generating any traffic. I wrote a small script to hit the endpoints.\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"while\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-literal\"}},[_vm._v(\"true\")]),_vm._v(\"; \\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"do\")]),_vm._v(\"\\n\\tcurl http://example-app-default.apps-crc.testing/\\n\\tcurl http://example-app-default.apps-crc.testing/hello\\n\\tcurl -X POST -H \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"\\\"Content-Type: application/json\\\"\")]),_vm._v(\" -d \"),_c('span',{pre:true,attrs:{\"class\":\"hljs-string\"}},[_vm._v(\"'{\\\"name\\\": \\\"test\\\", \\\"email\\\": \\\"test@example.com\\\"}'\")]),_vm._v(\" http://example-app-default.apps-crc.testing/\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-built_in\"}},[_vm._v(\"bye\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"hljs-keyword\"}},[_vm._v(\"done\")]),_vm._v(\"\\n\")])]),_c('p',[_vm._v(\"After a few minutes I am seeing the metric show up\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/tlyg5tq6ai7feprsprof.png\",\"alt\":\"screenshot of metrics\"}})]),_c('p',[_c('strong',[_vm._v(\"Up\")]),_vm._v(\"\\nI use this metric to determine if the container pods are up and running. As there should be 3 pods we sum the up's and divide by 3 to get a single metric , and add it to Grafana as a gauge panel.\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/f0esw9aljrlxuxzln4q7.png\",\"alt\":\"Container Up graph\"}})]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Prometheus expression \")]),_vm._v(\"\\nsum(up)/3\\n\")])]),_c('p',[_c('strong',[_vm._v(\"Average request duration Express-prometheus\")]),_vm._v(\"\\nThe Average request duration can be got by the following expression see \"),_c('a',{attrs:{\"href\":\"https://prometheus.io/docs/practices/histograms/#count-and-sum-of-observations\"}},[_vm._v(\"prometheus docs\")]),_vm._v(\" for more info.\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Prometheus expression\")]),_vm._v(\"\\nrate(http_request_duration_seconds_sum[5m])/ rate(http_request_duration_seconds_count[5m])\\n\")])]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/5uauqd6vacb6pr4dwey9.png\",\"alt\":\"Average request duration graph\"}})]),_c('p',[_c('strong',[_vm._v(\"Memory Metrics\")]),_vm._v(\"\\nThere are a lot of memory metrics exposed by the Express.js app.\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/zjyw8fxgozpew0knfzms.png\",\"alt\":\"memory metrics\"}})]),_c('p',[_vm._v(\"You can use any of these metrics for a panel.\\nIn my example will use the Memory Heap Used vs Heap Total.\")]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"# Prometheus expressions\")]),_vm._v(\"\\nnodejs_heap_size_used_bytes\\nnodejs_heap_size_total_bytes\\n\")])]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/46ty28qkbj21g5i4ybvx.png\",\"alt\":\"Memory Heap Used vs Heap Total graph\"}})]),_c('p',[_vm._v(\"Adding the two metric to the panel\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/mx0rvpom2w4u2w4i4o9r.png\",\"alt\":\"add two metrics screenshot\"}})]),_c('p',[_c('strong',[_vm._v(\"CPU Metrics\")]),_vm._v(\"\\nWith CPU again there are a few metrics exposed from the Express.js app. Again when we add the CPU metric Grafana prompts us to use these metrics with rate\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/trz7osynfqpl0m2l1dj2.png\",\"alt\":\"change to cpu rate\"}})]),_c('pre',{pre:true},[_c('code',{pre:true,attrs:{\"v-pre\":\"\",\"class\":\"language-bash\"}},[_c('span',{pre:true,attrs:{\"class\":\"hljs-comment\"}},[_vm._v(\"## Prometheus expressions\")]),_vm._v(\"\\nrate(process_cpu_seconds_total[5m])\\nrate(process_cpu_system_seconds_total[5m])\\nrate(process_cpu_user_seconds_total[5m])\\n\")])]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gk5rd2nu1xj8yxnejr21.png\",\"alt\":\"CPU Process graph\"}})]),_c('h2',[_vm._v(\"Dashboard\")]),_c('p',[_vm._v(\"Finally the Dashboard looks as follows\")]),_c('p',[_c('img',{attrs:{\"src\":\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/459r3wbi2n7rwmy9scxo.png\",\"alt\":\"Dashboard View\"}})])])}]\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./expressgrafana.md?vue&type=template&id=e4f692be&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}