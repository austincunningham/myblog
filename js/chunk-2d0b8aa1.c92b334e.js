(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b8aa1"],{"303a":function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},r=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("h1",[s._v("Kicking the tyres of 3scale API Management with the operator")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/g1pthz5lq9o4vfvfqhtb.png",alt:""}})]),a("p",[s._v("This is a shameless plug as I work on this product. This is a quick startup guide for getting 3scale up and running quickly with the 3scale-operator. This is not a production configuration and doesn't cover all configuration options.")]),a("h2",[s._v("Install with the 3scale-operator")]),a("p",[s._v("First we create a project")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("oc new-project 3scale-test\n")])]),a("p",[s._v("In the Openshift Administrator view we can then use the Operatorhub to install the 3scale operator into the project")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/xzicxnw321dq040zw7vd.gif",alt:"Install 3scale via the operatorhub"}})]),a("p",[s._v("Once installed we can create an APIManager CR to create an instance of 3scale. To do this we need a wildCardDomain that is resolvable in Openshift. You can setup a custom domain or you can use the Openshift default application router which I will used. This can be got from your Openshift console route  e.g.")]),a("p",[s._v("console-openshift-console."),a("strong",[s._v("apps.aucunnin.4mog.s1.devshift.org")])]),a("p",[s._v("You also need an "),a("a",{attrs:{href:"https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.8/html/installing_3scale/install-threescale-on-openshift-guide#configuring_amazon_simple_storage_service"}},[s._v("s3 bucket setup")]),s._v(". This bucket is used for storing CMS data for the customer web portal which I won't be covering in this blog. So once you have the bucket setup you will need its buck id , region and AWS key and secret. We create a secret in the project namespace")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("kind:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Secret")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("apiVersion:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("v1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("metadata:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("s3-credentials")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("namespace:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("3scale-test")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("AWS_ACCESS_KEY_ID:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("UkVQTEFDRV9NRQ==")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("AWS_BUCKET:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("UkVQTEFDRV9NRQ==")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("AWS_REGION:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("UkVQTEFDRV9NRQ==")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("AWS_SECRET_ACCESS_KEY:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("UkVQTEFDRV9NRQ==")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Opaque")]),s._v("\n")])]),a("p",[s._v("the values are base64 encoded e.g.")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("echo")]),s._v(" UkVQTEFDRV9NRQ== | base64 -d\nREPLACE_ME\n")])]),a("p",[s._v("Once the secret is created you can create the APIManager CR")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("apiVersion:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("apps.3scale.net/v1alpha1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("kind:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("APIManager")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("metadata:")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("apimanager-sample")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("namespace:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("3scale-test")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("spec:")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("system:")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fileStorage:")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("simpleStorageService:")]),s._v(" \n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("configurationSecretRef:")]),s._v(" \n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("s3-credentials")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("wildcardDomain:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("apps.aucunnin.4mog.s1.devshift.org")]),s._v("\n")])]),a("p",[s._v("Once the CR is created it should install 3scale. You can confirm the install is finished by checking the APIManager CR status , should look like the following.")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("# using https://mikefarah.gitbook.io/yq/")]),s._v("\noc get apimanager apimanager-sample -oyaml | yq "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'.status'")]),s._v("\nconditions:\n  - lastTransitionTime: "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"2023-02-17T14:29:27Z"')]),s._v("\n    status: "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"True"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("type")]),s._v(": Available\ndeployments:\n  ready:\n    - apicast-production\n    - apicast-staging\n    - backend-cron\n    - backend-listener\n    - backend-redis\n    - backend-worker\n    - system-app\n    - system-memcache\n    - system-mysql\n    - system-redis\n    - system-sidekiq\n    - system-sphinx\n    - zync\n    - zync-database\n    - zync-que\n")])]),a("h2",[s._v("Login to 3scale")]),a("p",[s._v("Once we reach this point we can play around with 3scale. We can use the "),a("strong",[s._v("3scale-admin")]),s._v(" route or the "),a("strong",[s._v("master")]),s._v(" route to log in the credentials for these are in the "),a("strong",[s._v("system-seed")]),s._v(" secret. I will use the admin route .")]),a("p",[s._v("Route")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/swvzkrwkdnuqrqnm1g1n.png",alt:"3scale-admin route"}})]),a("p",[s._v("Password")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ypa9mkr3quvjibytqfb0.gif",alt:"system-seed secret"}})]),a("p",[s._v("Click on the route and login as "),a("strong",[s._v("admin")]),s._v(" with the copied password and go through the welcome wizard.")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/gk3l0ayfcd9dtpgmkohg.gif",alt:"login plus wizard"}})]),a("h2",[s._v("Add your own API")]),a("p",[s._v("I am going to use a free API to demo this")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("curl -k https://catfact.ninja/fact  \n{"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fact"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Both humans and cats have identical regions in the brain responsible for emotion."')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"length"')]),s._v(":81}% \n")])]),a("h3",[s._v("Create a Backend")]),a("p",[s._v("From the dashboard click on "),a("strong",[s._v("Create Backend")]),s._v(" and fill out the form adding a valid api.")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/h26xnnfjht5lv3xxmd0c.gif",alt:"Add a backend"}})]),a("h3",[s._v("Create a Product")]),a("p",[s._v("From the dashboard click on "),a("strong",[s._v("Create Product")]),s._v(" and fill out the form")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/mhdqug12qjomy7c5neew.gif",alt:"Add a product"}})]),a("h3",[s._v("Add Application Plan")]),a("p",[s._v("From the Product screen select "),a("strong",[s._v("Application")]),s._v(" and "),a("strong",[s._v("Application Plan")]),s._v(" and fill out the form, you can add thing like price plans, trial periods etc.")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/rds6zglnv1fl4umxx6pc.gif",alt:"Create an application plan"}})]),a("h3",[s._v("Add an Application")]),a("p",[s._v("From the Product screen select "),a("strong",[s._v("Application")]),s._v(" and "),a("strong",[s._v("Listing")]),s._v(" and then the "),a("strong",[s._v("Create Application")]),s._v(" button and fill out the form again")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/fkgn6jaszr03urohp7mt.gif",alt:"create an application"}})]),a("h3",[s._v("Link your Backend to your Product")]),a("p",[s._v("From the dashboard click on the product you created earlier, Click on "),a("strong",[s._v("Integration\\Configuration")]),s._v(" and add the backend to your product.")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/x2o068eodo0vxgr1sp8y.gif",alt:"Link your backend to your product"}})]),a("h3",[s._v("Promote to staging and production")]),a("p",[s._v("From the products screen click on "),a("strong",[s._v("Integration\\Configuration")]),s._v(" again and click on the button to promote to staging and production")]),a("p",[a("img",{attrs:{src:"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/x6ard5bsd8h03mf8w1br.gif",alt:"promote to staging and production"}})]),a("p",[s._v("You can check the staging url out with the curl command e.g.")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("curl "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"https://catfact-3scale-apicast-staging.apps.aucunnin.4mog.s1.devshift.org:443/?user_key=073a4f36364b635c156811dcc1728d32"')]),s._v("\n{"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fact"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Phoenician cargo ships are thought to have brought the first domesticated cats to Europe in about 900 BC."')]),s._v(","),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"length"')]),s._v(":105}%\n")])]),a("p",[s._v("That it for kicking the tyres , there is a lot more you can add to your product such as analytics, metrics, policies, API docs\\ActiveDocs. There are plenty of other features but I won't go into them as I would just be covering what is already in the "),a("a",{attrs:{href:"https://access.redhat.com/documentation/en-us/red_hat_3scale_api_management/2.10"}},[s._v("docs")])])])}],n=a("2877"),o={},c=Object(n["a"])(o,e,r,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d0b8aa1.c92b334e.js.map